<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="heemod">
<title>Survival models â€¢ heemod</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Survival models">
<meta property="og:description" content="heemod">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">heemod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_introduction.html">An Introduction to `heemod`</a>
    <a class="dropdown-item" href="../articles/b_time_dependency.html">Time-varying values</a>
    <a class="dropdown-item" href="../articles/c_homogeneous.html">Simple Markov Models (Homogeneous)</a>
    <a class="dropdown-item" href="../articles/d_non_homogeneous.html">Time-varying Markov Models (Non-Homogeneous)</a>
    <a class="dropdown-item" href="../articles/e_probabilistic.html">Probabilistic Uncertainty Analysis</a>
    <a class="dropdown-item" href="../articles/f_sensitivity.html">Deterministic Sensitivity Analysis</a>
    <a class="dropdown-item" href="../articles/g_heterogeneity.html">Heterogeneity &amp; Demographic Analysis</a>
    <a class="dropdown-item" href="../articles/h_tabular.html">Tabular Input</a>
    <a class="dropdown-item" href="../articles/i_reproduction.html">Reproducing Exact Results from DMHEE</a>
    <a class="dropdown-item" href="../articles/j_survival.html">Survival models</a>
    <a class="dropdown-item" href="../articles/j_survival_2_psa.html">Survival Models Part 2 - PSA</a>
    <a class="dropdown-item" href="../articles/k_calibration.html">Calibrating `heemod` models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aphp/heemod/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Survival models</h1>
            
            <h4 data-toc-skip class="date">2024-02-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/aphp/heemod/blob/HEAD/vignettes/j_survival.Rmd" class="external-link"><code>vignettes/j_survival.Rmd</code></a></small>
      <div class="d-none name"><code>j_survival.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="distributions">Distributions<a class="anchor" aria-label="anchor" href="#distributions"></a>
</h2>
<p>The <code>heemod</code> package provides a number of ways to estimate
transition probabilities from survival distributions. Survival
distributions can come from at least three different sources:</p>
<ul>
<li>User-defined parametric distributions with
<code><a href="../reference/define_surv_dist.html">define_surv_dist()</a></code> or
<code><a href="../reference/define_surv_spline.html">define_surv_spline()</a></code>.</li>
<li>Fitted survival models with a Kaplan-Meier estimator or parametric
distributions with <code><a href="../reference/define_surv_fit.html">define_surv_fit()</a></code>
</li>
<li>Survival Tables with <code><a href="../reference/define_surv_table.html">define_surv_table()</a></code>
</li>
</ul>
<p>Once defined, each of these types of distributions can be combined
and modified using a standard set of operations.</p>
<p>User-defined parametric distributions are created using the
<code><a href="../reference/define_surv_dist.html">define_surv_dist()</a></code> and <code><a href="../reference/define_surv_spline.html">define_surv_spline()</a></code>
functions:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surv_dist_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_surv_dist.html">define_surv_dist</a></span><span class="op">(</span></span>
<span>  distribution <span class="op">=</span> <span class="st">"exp"</span>,</span>
<span>  rate <span class="op">=</span> <span class="fl">.5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">surv_dist_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_surv_spline.html">define_surv_spline</a></span><span class="op">(</span></span>
<span>  scale <span class="op">=</span> <span class="st">"odds"</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">11.643</span>, <span class="fl">1.843</span>, <span class="fl">0.208</span><span class="op">)</span>,</span>
<span>  knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.077537</span>, <span class="fl">5.883183</span>, <span class="fl">6.458338</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required namespace: flexsurv</span></span></code></pre>
<p>Fitted Kaplan-Meier curves are created using
<code><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survival::survfit()</a></code> wrapped into
<code><a href="../reference/define_surv_fit.html">define_surv_fit()</a></code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chjackson/flexsurv-dev" class="external-link">flexsurv</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: survival</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flexsurv/man/flexsurvreg.html" class="external-link">flexsurvreg</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">fustat</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">ovarian</span>, dist <span class="op">=</span> <span class="st">"weibull"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/define_surv_fit.html">define_surv_fit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_w</span><span class="op">)</span></span></code></pre></div>
<p><img src="j_survival_files/figure-html/unnamed-chunk-2-1.png" width="576"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_spl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flexsurv/man/flexsurvspline.html" class="external-link">flexsurvspline</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">fustat</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">ovarian</span>,</span>
<span>  scale <span class="op">=</span> <span class="st">"odds"</span>,</span>
<span>  k<span class="op">=</span><span class="fl">1</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/define_surv_fit.html">define_surv_fit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_spl</span><span class="op">)</span></span></code></pre></div>
<p><img src="j_survival_files/figure-html/unnamed-chunk-2-2.png" width="576"></p>
<p>Fitted models can include covariates. In order to use a model with
covariates in heemod, you can use the <code><a href="../reference/set_covariates.html">set_covariates()</a></code>
function on the fitted model and provide as additional arguments the
covariate values you want to model. You can also provide a data frame of
covariate levels to aggregate survival probabilities over different
groups. By default, heemod will aggregate over predicted survival
probabilities for each subject in the dataset to which the model was
fit.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flexsurv/man/flexsurvreg.html" class="external-link">flexsurvreg</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">rectime</span>, <span class="va">censrec</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>,</span>
<span>  dist <span class="op">=</span> <span class="st">"weibull"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">bc</span></span>
<span><span class="op">)</span><span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/define_surv_fit.html">define_surv_fit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_cov</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No covariates provided, returning aggregate survival across all subjects.</span></span></code></pre>
<p><img src="j_survival_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitcov_good</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_covariates.html">set_covariates</a></span><span class="op">(</span><span class="va">fit_cov</span>, group <span class="op">=</span> <span class="st">"Good"</span><span class="op">)</span></span>
<span><span class="va">fitcov_medium</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_covariates.html">set_covariates</a></span><span class="op">(</span><span class="va">fit_cov</span>, group <span class="op">=</span> <span class="st">"Medium"</span><span class="op">)</span></span>
<span><span class="va">fitcov_poor</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_covariates.html">set_covariates</a></span><span class="op">(</span><span class="va">fit_cov</span>, group <span class="op">=</span> <span class="st">"Poor"</span><span class="op">)</span></span></code></pre></div>
<p>Similar functionality is also available for fitted parametric models
created using <code><a href="https://rdrr.io/pkg/flexsurv/man/flexsurvreg.html" class="external-link">flexsurv::flexsurvreg()</a></code> and
<code><a href="https://rdrr.io/pkg/flexsurv/man/flexsurvspline.html" class="external-link">flexsurv::flexsurvspline()</a></code> wrapped into
<code><a href="../reference/define_surv_fit.html">define_surv_fit()</a></code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">km_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">fustat</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">ovarian</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="../reference/define_surv_fit.html">define_surv_fit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">km_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">rectime</span>, <span class="va">censrec</span><span class="op">)</span> <span class="op">~</span> <span class="va">group</span>,</span>
<span>  data <span class="op">=</span> <span class="va">bc</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="../reference/define_surv_fit.html">define_surv_fit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">km_cov</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No covariates provided, returning aggregate survival across all subjects.</span></span></code></pre>
<p><img src="j_survival_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_good</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_covariates.html">set_covariates</a></span><span class="op">(</span><span class="va">km_cov</span>, group <span class="op">=</span> <span class="st">"Good"</span><span class="op">)</span></span>
<span><span class="va">km_medium</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_covariates.html">set_covariates</a></span><span class="op">(</span><span class="va">km_cov</span>, group <span class="op">=</span> <span class="st">"Medium"</span><span class="op">)</span></span>
<span><span class="va">km_poor</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_covariates.html">set_covariates</a></span><span class="op">(</span><span class="va">km_cov</span>, group <span class="op">=</span> <span class="st">"Poor"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="operations">Operations<a class="anchor" aria-label="anchor" href="#operations"></a>
</h2>
<p>Once defined, treatment effects of various types can be applied to
any survival distribution:</p>
<ul>
<li>Hazard ratio: <code><a href="../reference/apply_hr.html">apply_hr()</a></code>.</li>
<li>Odds ratio: <code><a href="../reference/apply_or.html">apply_or()</a></code>.</li>
<li>Acceleration factor: <code><a href="../reference/apply_af.html">apply_af()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_poor_ph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_hr.html">apply_hr</a></span><span class="op">(</span><span class="va">km_poor</span>, hr <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">km_medium_af</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_af.html">apply_af</a></span><span class="op">(</span><span class="va">km_medium</span>, af <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></code></pre></div>
<p>In addition, distributions can be combined using a variety of
operations:</p>
<ul>
<li>Join survival distributions together: <code><a href="../reference/join.html">join()</a></code>.</li>
<li>Mix two (or more) survival distributions: <code><a href="../reference/mix.html">mix()</a></code>.</li>
<li>Combine two (or more) survival distributions as independent risks:
<code><a href="../reference/add_hazards.html">add_hazards()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_poor_join</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join.html">join</a></span><span class="op">(</span></span>
<span>  <span class="va">km_poor</span>,</span>
<span>  <span class="va">fitcov_poor</span>,</span>
<span>  at <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span><span class="va">models_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mix.html">mix</a></span><span class="op">(</span></span>
<span>  <span class="va">fitcov_good</span>, <span class="va">fitcov_medium</span>, <span class="va">fitcov_poor</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">combined_risks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_hazards.html">add_hazards</a></span><span class="op">(</span></span>
<span>  <span class="va">fit_w</span>, <span class="va">fitcov_good</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The transition or survival probabilities are computed with
<code><a href="../reference/compute_surv.html">compute_surv()</a></code>. Time (usually <code>model_time</code> or
<code>state_time</code>) needs to be passed to the function as a
<code>time</code> argument.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compute_surv.html">compute_surv</a></span><span class="op">(</span><span class="va">surv_dist_2</span>, time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 8.780223e-06 2.271877e-05 3.500128e-05 4.649850e-05 5.747782e-05</span></span></code></pre>
<p>All these operations can be chained with the <code>|&gt;</code> pipe
operator.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cov</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/set_covariates.html">set_covariates</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"Good"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/apply_hr.html">apply_hr</a></span><span class="op">(</span>hr <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/join.html">join</a></span><span class="op">(</span></span>
<span>    <span class="va">fitcov_poor</span>,</span>
<span>    at <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mix.html">mix</a></span><span class="op">(</span></span>
<span>    <span class="va">fitcov_medium</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_hazards.html">add_hazards</a></span><span class="op">(</span></span>
<span>    <span class="va">fit_w</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/compute_surv.html">compute_surv</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0004011356 0.0004736851 0.0005069766 0.0005490092 0.0005692261</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="applications">Applications<a class="anchor" aria-label="anchor" href="#applications"></a>
</h2>
<div class="section level3">
<h3 id="transition-matrix">Transition matrix<a class="anchor" aria-label="anchor" href="#transition-matrix"></a>
</h3>
<p>For the example we define a simple model with only 1 strategy.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_parameters.html">define_parameters</a></span><span class="op">(</span></span>
<span>  p1 <span class="op">=</span> <span class="fu"><a href="../reference/compute_surv.html">compute_surv</a></span><span class="op">(</span></span>
<span>    <span class="va">surv_dist_1</span>,</span>
<span>    time <span class="op">=</span> <span class="va">model_time</span> <span class="co"># can also be state_time</span></span>
<span>  <span class="op">)</span>,</span>
<span>  p2 <span class="op">=</span> <span class="va">km_1</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/join.html">join</a></span><span class="op">(</span><span class="va">fit_w</span>, at <span class="op">=</span> <span class="fl">730</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/compute_surv.html">compute_surv</a></span><span class="op">(</span></span>
<span>      time <span class="op">=</span> <span class="va">model_time</span>,</span>
<span>      cycle_length <span class="op">=</span> <span class="fl">365</span>  <span class="co"># time is in days in km_medium, in years in model_time</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_transition.html">define_transition</a></span><span class="op">(</span></span>
<span>  <span class="va">C</span>, <span class="va">p1</span> <span class="op">-</span> <span class="va">p2</span>, <span class="va">p2</span>,</span>
<span>  <span class="fl">0</span>, <span class="va">C</span>,       <span class="va">p2</span>,</span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>,       <span class="va">C</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No named state -&gt; generating names.</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required namespace: diagram</span></span></code></pre>
<p><img src="j_survival_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sA</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost <span class="op">=</span> <span class="fl">10</span>, ut <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sB</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost <span class="op">=</span> <span class="fl">20</span>, ut <span class="op">=</span> <span class="fl">.5</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sC</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost <span class="op">=</span> <span class="fl">0</span>, ut <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">stratTM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_strategy.html">define_strategy</a></span><span class="op">(</span></span>
<span>  transition <span class="op">=</span> <span class="va">tm</span>,</span>
<span>  A <span class="op">=</span> <span class="va">sA</span>, B <span class="op">=</span> <span class="va">sB</span>, C <span class="op">=</span> <span class="va">sC</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">resTM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span></span>
<span>  parameters <span class="op">=</span> <span class="va">param</span>,</span>
<span>  <span class="va">stratTM</span>,</span>
<span>  cycles <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  cost <span class="op">=</span> <span class="va">cost</span>, effect <span class="op">=</span> <span class="va">ut</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No named model -&gt; generating names.</span></span></code></pre>
<pre><code><span><span class="co">## No covariates provided, returning aggregate survival across all subjects.</span></span>
<span><span class="co">## No covariates provided, returning aggregate survival across all subjects.</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">resTM</span><span class="op">)</span></span></code></pre></div>
<p><img src="j_survival_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="partitioned-survival-model">Partitioned survival model<a class="anchor" aria-label="anchor" href="#partitioned-survival-model"></a>
</h3>
<p>A partitioned survival model can also be computed:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_part_surv.html">define_part_surv</a></span><span class="op">(</span></span>
<span>  pfs <span class="op">=</span> <span class="va">surv_dist_1</span>,</span>
<span>  os  <span class="op">=</span> <span class="va">km_1</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/join.html">join</a></span><span class="op">(</span><span class="va">fit_w</span>, at <span class="op">=</span> <span class="fl">730</span><span class="op">)</span>,</span>
<span>  cycle_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">365</span><span class="op">)</span> <span class="co"># 1 for pfs, 365 for os</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No named state -&gt; generating names.</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stratPS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_strategy.html">define_strategy</a></span><span class="op">(</span></span>
<span>  transition <span class="op">=</span> <span class="va">ps</span>,</span>
<span>  A <span class="op">=</span> <span class="va">sA</span>, B <span class="op">=</span> <span class="va">sB</span>, C <span class="op">=</span> <span class="va">sC</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">resPS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span></span>
<span>  <span class="va">stratPS</span>,</span>
<span>  cycles <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  cost <span class="op">=</span> <span class="va">cost</span>, effect <span class="op">=</span> <span class="va">ut</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No named model -&gt; generating names.</span></span></code></pre>
<pre><code><span><span class="co">## No covariates provided, returning aggregate survival across all subjects.</span></span>
<span><span class="co">## No covariates provided, returning aggregate survival across all subjects.</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">resPS</span><span class="op">)</span></span></code></pre></div>
<p><img src="j_survival_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kevin Zarca, Antoine Filipovic-Pierucci.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
