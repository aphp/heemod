<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="heemod">
<title>Reproducing Exact Results from DMHEE • heemod</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reproducing Exact Results from DMHEE">
<meta property="og:description" content="heemod">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">heemod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_introduction.html">An Introduction to `heemod`</a>
    <a class="dropdown-item" href="../articles/b_time_dependency.html">Time-varying values</a>
    <a class="dropdown-item" href="../articles/c_homogeneous.html">Simple Markov Models (Homogeneous)</a>
    <a class="dropdown-item" href="../articles/d_non_homogeneous.html">Time-varying Markov Models (Non-Homogeneous)</a>
    <a class="dropdown-item" href="../articles/e_probabilistic.html">Probabilistic Uncertainty Analysis</a>
    <a class="dropdown-item" href="../articles/f_sensitivity.html">Deterministic Sensitivity Analysis</a>
    <a class="dropdown-item" href="../articles/g_heterogeneity.html">Heterogeneity &amp; Demographic Analysis</a>
    <a class="dropdown-item" href="../articles/h_tabular.html">Tabular Input</a>
    <a class="dropdown-item" href="../articles/i_reproduction.html">Reproducing Exact Results from DMHEE</a>
    <a class="dropdown-item" href="../articles/j_survival.html">Survival models</a>
    <a class="dropdown-item" href="../articles/j_survival_2_psa.html">Survival Models Part 2 - PSA</a>
    <a class="dropdown-item" href="../articles/k_calibration.html">Calibrating `heemod` models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aphp/heemod/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Reproducing Exact Results from DMHEE</h1>
            
            <h4 data-toc-skip class="date">2024-02-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/aphp/heemod/blob/HEAD/vignettes/i_reproduction.Rmd" class="external-link"><code>vignettes/i_reproduction.Rmd</code></a></small>
      <div class="d-none name"><code>i_reproduction.Rmd</code></div>
    </div>

    
    
<p>The purpose of this vignette is to present how to reproduce exactly
the results from <a href="https://global.oup.com/academic/product/decision-modelling-for-health-economic-evaluation-9780198526629" class="external-link">Decision
Modelling for Health Economic Evaluation</a>. While other vignettes such
as <code>vignette("c-homogeneous", "heemod")</code>,
<code>vignette("d-non-homogeneous", "heemod")</code> or
<code>vignette("e-probabilistic", "heemod")</code> are greatly inspired
from this book, key elements differ (mostly for the sake of clarity) and
thus results differ, sometimes significantly, from the book. Here we
show how to exactly reproduce the results with the <code>heemod</code>
package.</p>
<div class="section level2">
<h2 id="hiv-model">HIV model<a class="anchor" aria-label="anchor" href="#hiv-model"></a>
</h2>
<p>Key differences in DMHEE:</p>
<ol style="list-style-type: decimal">
<li>transitions occur at the end of each year,</li>
<li>cost are counted starting from year 1, not year 0,</li>
<li>treatment stops after 2 years,</li>
<li>rounding errors.</li>
</ol>
<p>It is possible to reproduce 1. and 2. by making transition happen at
the end of each year with method = “end”. Since with this method the
transition occur 1 year after the beginning, costs should be discounted
from the first cycle with the argument first = TRUE in discount(). Point
3. is reproduced by making <code>rr</code> and <code>cost_lami</code> a
time changing variable like this
<code>rr = ifelse(model_time &lt;= 2, .509, 1.00)</code>.</p>
<p>The last point is reproduced by writing transition probabilities as
fractions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">par_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_parameters.html">define_parameters</a></span><span class="op">(</span></span>
<span>  rr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">model_time</span> <span class="op">&lt;=</span> <span class="fl">2</span>, <span class="fl">.509</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  cost_lami <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">model_time</span> <span class="op">&lt;=</span> <span class="fl">2</span>, <span class="fl">2086.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  cost_zido <span class="op">=</span> <span class="fl">2278</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mat_mono</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_transition.html">define_transition</a></span><span class="op">(</span></span>
<span>  <span class="fl">1251</span><span class="op">/</span><span class="fl">1734</span>, <span class="fl">350</span><span class="op">/</span><span class="fl">1734</span>, <span class="fl">116</span><span class="op">/</span><span class="fl">1734</span>,  <span class="fl">17</span><span class="op">/</span><span class="fl">1734</span>,</span>
<span>  <span class="fl">0</span>,         <span class="fl">731</span><span class="op">/</span><span class="fl">1258</span>, <span class="fl">512</span><span class="op">/</span><span class="fl">1258</span>,  <span class="fl">15</span><span class="op">/</span><span class="fl">1258</span>,</span>
<span>  <span class="fl">0</span>,         <span class="fl">0</span>,        <span class="fl">1312</span><span class="op">/</span><span class="fl">1749</span>, <span class="fl">437</span><span class="op">/</span><span class="fl">1749</span>,</span>
<span>  <span class="fl">0</span>,         <span class="fl">0</span>,        <span class="fl">0</span>,         <span class="fl">1.00</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No named state -&gt; generating names.</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_transition.html">define_transition</a></span><span class="op">(</span></span>
<span>  <span class="va">C</span>, <span class="fl">350</span><span class="op">/</span><span class="fl">1734</span><span class="op">*</span><span class="va">rr</span>, <span class="fl">116</span><span class="op">/</span><span class="fl">1734</span><span class="op">*</span><span class="va">rr</span>, <span class="fl">17</span><span class="op">/</span><span class="fl">1734</span><span class="op">*</span><span class="va">rr</span>,</span>
<span>  <span class="fl">0</span>, <span class="va">C</span>,           <span class="fl">512</span><span class="op">/</span><span class="fl">1258</span><span class="op">*</span><span class="va">rr</span>, <span class="fl">15</span><span class="op">/</span><span class="fl">1258</span><span class="op">*</span><span class="va">rr</span>,</span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>,           <span class="va">C</span>,           <span class="fl">437</span><span class="op">/</span><span class="fl">1749</span><span class="op">*</span><span class="va">rr</span>,</span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>,           <span class="fl">0</span>,           <span class="fl">1.00</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No named state -&gt; generating names.</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A_mono</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost_health <span class="op">=</span> <span class="fl">2756</span>,</span>
<span>  cost_drugs <span class="op">=</span> <span class="va">cost_zido</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span></span>
<span>    <span class="va">cost_health</span> <span class="op">+</span> <span class="va">cost_drugs</span>, <span class="fl">.06</span>, first <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">B_mono</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost_health <span class="op">=</span> <span class="fl">3052</span>,</span>
<span>  cost_drugs <span class="op">=</span> <span class="va">cost_zido</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span></span>
<span>    <span class="va">cost_health</span> <span class="op">+</span> <span class="va">cost_drugs</span>, <span class="fl">.06</span>, first <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">C_mono</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost_health <span class="op">=</span> <span class="fl">9007</span>,</span>
<span>  cost_drugs <span class="op">=</span> <span class="va">cost_zido</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span></span>
<span>    <span class="va">cost_health</span> <span class="op">+</span> <span class="va">cost_drugs</span>, <span class="fl">.06</span>, first <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">D_mono</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost_health <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_drugs <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span></span>
<span>    <span class="va">cost_health</span> <span class="op">+</span> <span class="va">cost_drugs</span>, <span class="fl">.06</span>, first <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">A_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost_health <span class="op">=</span> <span class="fl">2756</span>,</span>
<span>  cost_drugs <span class="op">=</span> <span class="va">cost_zido</span> <span class="op">+</span> <span class="va">cost_lami</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span></span>
<span>    <span class="va">cost_health</span> <span class="op">+</span> <span class="va">cost_drugs</span>, <span class="fl">.06</span>, first <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">B_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost_health <span class="op">=</span> <span class="fl">3052</span>,</span>
<span>  cost_drugs <span class="op">=</span> <span class="va">cost_zido</span> <span class="op">+</span> <span class="va">cost_lami</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span></span>
<span>    <span class="va">cost_health</span> <span class="op">+</span> <span class="va">cost_drugs</span>, <span class="fl">.06</span>, first <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">C_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost_health <span class="op">=</span> <span class="fl">9007</span>,</span>
<span>  cost_drugs <span class="op">=</span> <span class="va">cost_zido</span> <span class="op">+</span> <span class="va">cost_lami</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span></span>
<span>    <span class="va">cost_health</span> <span class="op">+</span> <span class="va">cost_drugs</span>, <span class="fl">.06</span>, first <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">D_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>  cost_health <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_drugs <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span></span>
<span>    <span class="va">cost_health</span> <span class="op">+</span> <span class="va">cost_drugs</span>, <span class="fl">.06</span>, first <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_mono</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_strategy.html">define_strategy</a></span><span class="op">(</span></span>
<span>  transition <span class="op">=</span> <span class="va">mat_mono</span>,</span>
<span>  <span class="va">A_mono</span>,</span>
<span>  <span class="va">B_mono</span>,</span>
<span>  <span class="va">C_mono</span>,</span>
<span>  <span class="va">D_mono</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No named state -&gt; generating names.</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_strategy.html">define_strategy</a></span><span class="op">(</span></span>
<span>  transition <span class="op">=</span> <span class="va">mat_comb</span>,</span>
<span>  <span class="va">A_comb</span>,</span>
<span>  <span class="va">B_comb</span>,</span>
<span>  <span class="va">C_comb</span>,</span>
<span>  <span class="va">D_comb</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No named state -&gt; generating names.</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span></span>
<span>  mono <span class="op">=</span> <span class="va">mod_mono</span>,</span>
<span>  comb <span class="op">=</span> <span class="va">mod_comb</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">par_mod</span>,</span>
<span>  cycles <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  cost <span class="op">=</span> <span class="va">cost_total</span>,</span>
<span>  effect <span class="op">=</span> <span class="va">life_year</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"end"</span>,</span>
<span>  init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_mod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2 strategies run for 20 cycles.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initial state counts:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## A = 1</span></span>
<span><span class="co">## B = 0</span></span>
<span><span class="co">## C = 0</span></span>
<span><span class="co">## D = 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Counting method: 'end'.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Values:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      cost_health cost_drugs cost_total life_year</span></span>
<span><span class="co">## mono    45541.24   18203.97   44663.45  7.991207</span></span>
<span><span class="co">## comb    48082.83   24492.28   50601.65  8.937389</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Efficiency frontier:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## mono -&gt; comb</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Differences:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      Cost Diff. Effect Diff.     ICER Ref.</span></span>
<span><span class="co">## comb   5938.198    0.9461822 6275.956 mono</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="thr-model">THR model<a class="anchor" aria-label="anchor" href="#thr-model"></a>
</h2>
<p>Key difference in DMHEE:</p>
<ol style="list-style-type: decimal">
<li>Mortality rates are much higher in the book.</li>
</ol>
<p>This can be corrected by using a user-specified mortality table and
then fetch the values with:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/look_up.html">look_up</a></span><span class="op">(</span><span class="va">death_prob</span>, age <span class="op">=</span> <span class="va">age</span>, sex <span class="op">=</span> <span class="va">sex</span>, bin <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a function to return age-related mortality rate</span></span>
<span><span class="co"># given age and sex</span></span>
<span><span class="va">death_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">85</span>, <span class="fl">10</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1.51e-3</span>, <span class="fl">.99e-3</span>, <span class="fl">3.93e-3</span>,</span>
<span>    <span class="fl">2.6e-3</span>, <span class="fl">10.9e-3</span>, <span class="fl">6.7e-3</span>,</span>
<span>    <span class="fl">31.6e-3</span>, <span class="fl">19.3e-3</span>, <span class="fl">80.1e-3</span>,</span>
<span>    <span class="fl">53.5e-3</span>, <span class="fl">187.9e-3</span>, <span class="fl">154.8e-3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">death_prob</span></span></code></pre></div>
<pre><code><span><span class="co">##    age sex   value</span></span>
<span><span class="co">## 1   35   1 0.00151</span></span>
<span><span class="co">## 2   35   0 0.00099</span></span>
<span><span class="co">## 3   45   1 0.00393</span></span>
<span><span class="co">## 4   45   0 0.00260</span></span>
<span><span class="co">## 5   55   1 0.01090</span></span>
<span><span class="co">## 6   55   0 0.00670</span></span>
<span><span class="co">## 7   65   1 0.03160</span></span>
<span><span class="co">## 8   65   0 0.01930</span></span>
<span><span class="co">## 9   75   1 0.08010</span></span>
<span><span class="co">## 10  75   0 0.05350</span></span>
<span><span class="co">## 11  85   1 0.18790</span></span>
<span><span class="co">## 12  85   0 0.15480</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_parameters.html">define_parameters</a></span><span class="op">(</span></span>
<span>    age_init <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    sex <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    <span class="co"># age increases with cycles</span></span>
<span>    age <span class="op">=</span> <span class="va">age_init</span> <span class="op">+</span> <span class="va">model_time</span>,</span>
<span>    </span>
<span>    <span class="co"># operative mortality rates</span></span>
<span>    omrPTHR <span class="op">=</span> <span class="fl">.02</span>,</span>
<span>    omrRTHR <span class="op">=</span> <span class="fl">.02</span>,</span>
<span>    </span>
<span>    <span class="co"># re-revision mortality rate</span></span>
<span>    rrr <span class="op">=</span> <span class="fl">.04</span>,</span>
<span>    </span>
<span>    <span class="co"># parameters for calculating primary revision rate</span></span>
<span>    cons <span class="op">=</span> <span class="op">-</span><span class="fl">5.490935</span>,</span>
<span>    ageC <span class="op">=</span> <span class="op">-</span><span class="fl">.0367022</span>,</span>
<span>    maleC <span class="op">=</span> <span class="fl">.768536</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">cons</span> <span class="op">+</span> <span class="va">ageC</span> <span class="op">*</span> <span class="va">age_init</span> <span class="op">+</span> <span class="va">maleC</span> <span class="op">*</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>    lngamma <span class="op">=</span> <span class="fl">0.3740968</span>,</span>
<span>    gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lngamma</span><span class="op">)</span>,</span>
<span>    lnrrNP1 <span class="op">=</span> <span class="op">-</span><span class="fl">1.344474</span>,</span>
<span>    rrNP1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lnrrNP1</span><span class="op">)</span>,</span>
<span>   </span>
<span>    <span class="co"># revision probability of primary procedure</span></span>
<span>    standardRR <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lambda</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">model_time</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">^</span> <span class="va">gamma</span> <span class="op">-</span></span>
<span>                                     <span class="va">model_time</span> <span class="op">^</span> <span class="va">gamma</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    np1RR <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lambda</span> <span class="op">*</span> <span class="va">rrNP1</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">model_time</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">^</span> <span class="va">gamma</span> <span class="op">-</span> </span>
<span>                                        <span class="va">model_time</span> <span class="op">^</span> <span class="va">gamma</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># age-related mortality rate</span></span>
<span>    sex_cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">"FMLE"</span>, <span class="st">"MLE"</span><span class="op">)</span>,</span>
<span>    mr <span class="op">=</span> <span class="fu"><a href="../reference/look_up.html">look_up</a></span><span class="op">(</span><span class="va">death_prob</span>, age <span class="op">=</span> <span class="va">age</span>, sex <span class="op">=</span> <span class="va">sex</span>, bin <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span>,</span>
<span>    </span>
<span>    u_successP <span class="op">=</span> <span class="fl">.85</span>,</span>
<span>    u_revisionTHR <span class="op">=</span> <span class="fl">.30</span>,</span>
<span>    u_successR <span class="op">=</span> <span class="fl">.75</span>,</span>
<span>    c_revisionTHR <span class="op">=</span> <span class="fl">5294</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mat_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_transition.html">define_transition</a></span><span class="op">(</span></span>
<span>    state_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"PrimaryTHR"</span>,</span>
<span>      <span class="st">"SuccessP"</span>,</span>
<span>      <span class="st">"RevisionTHR"</span>,</span>
<span>      <span class="st">"SuccessR"</span>,</span>
<span>      <span class="st">"Death"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fl">0</span>, <span class="va">C</span>, <span class="fl">0</span>,          <span class="fl">0</span>, <span class="va">omrPTHR</span>,</span>
<span>    <span class="fl">0</span>, <span class="va">C</span>, <span class="va">standardRR</span>, <span class="fl">0</span>, <span class="va">mr</span>,</span>
<span>    <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,          <span class="va">C</span>, <span class="va">omrRTHR</span><span class="op">+</span><span class="va">mr</span>,</span>
<span>    <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">rrr</span>,        <span class="va">C</span>, <span class="va">mr</span>,</span>
<span>    <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,          <span class="fl">0</span>, <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mat_np1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_transition.html">define_transition</a></span><span class="op">(</span></span>
<span>    state_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"PrimaryTHR"</span>,</span>
<span>      <span class="st">"SuccessP"</span>,</span>
<span>      <span class="st">"RevisionTHR"</span>,</span>
<span>      <span class="st">"SuccessR"</span>,</span>
<span>      <span class="st">"Death"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fl">0</span>, <span class="va">C</span>, <span class="fl">0</span>,     <span class="fl">0</span>, <span class="va">omrPTHR</span>,</span>
<span>    <span class="fl">0</span>, <span class="va">C</span>, <span class="va">np1RR</span>, <span class="fl">0</span>, <span class="va">mr</span>,</span>
<span>    <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,     <span class="va">C</span>, <span class="va">omrRTHR</span><span class="op">+</span><span class="va">mr</span>,</span>
<span>    <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">rrr</span>,   <span class="va">C</span>, <span class="va">mr</span>,</span>
<span>    <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,     <span class="fl">0</span>, <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_strategy.html">define_strategy</a></span><span class="op">(</span></span>
<span>  transition <span class="op">=</span> <span class="va">mat_standard</span>,</span>
<span>  PrimaryTHR <span class="op">=</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>    utility <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    cost <span class="op">=</span> <span class="fl">394</span></span>
<span>  <span class="op">)</span>,</span>
<span>  SuccessP <span class="op">=</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>    utility <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span><span class="va">u_successP</span>, <span class="fl">.015</span><span class="op">)</span>,</span>
<span>    cost <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span>,</span>
<span>  RevisionTHR <span class="op">=</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>    utility <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span><span class="va">u_revisionTHR</span>, <span class="fl">.015</span><span class="op">)</span>,</span>
<span>    cost <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span><span class="va">c_revisionTHR</span>, <span class="fl">.06</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  SuccessR <span class="op">=</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>    utility <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span><span class="va">u_successR</span>, <span class="fl">.015</span><span class="op">)</span>,</span>
<span>    cost <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Death <span class="op">=</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>    utility <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    cost <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod_np1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_strategy.html">define_strategy</a></span><span class="op">(</span></span>
<span>  transition <span class="op">=</span> <span class="va">mat_np1</span>,</span>
<span>  PrimaryTHR <span class="op">=</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>    utility <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    cost <span class="op">=</span> <span class="fl">579</span></span>
<span>  <span class="op">)</span>,</span>
<span>  SuccessP <span class="op">=</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>    utility <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span><span class="va">u_successP</span>, <span class="fl">.015</span><span class="op">)</span>,</span>
<span>    cost <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span>,</span>
<span>  RevisionTHR <span class="op">=</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>    utility <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span><span class="va">u_revisionTHR</span>, <span class="fl">.015</span><span class="op">)</span>,</span>
<span>    cost <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span><span class="va">c_revisionTHR</span>, <span class="fl">.06</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  SuccessR <span class="op">=</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>    utility <span class="op">=</span> <span class="fu"><a href="../reference/discount.html">discount</a></span><span class="op">(</span><span class="va">u_successR</span>, <span class="fl">.015</span><span class="op">)</span>,</span>
<span>    cost <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Death <span class="op">=</span> <span class="fu"><a href="../reference/define_state.html">define_state</a></span><span class="op">(</span></span>
<span>    utility <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    cost <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_model.html">run_model</a></span><span class="op">(</span></span>
<span>  standard <span class="op">=</span> <span class="va">mod_standard</span>,</span>
<span>  np1 <span class="op">=</span> <span class="va">mod_np1</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">param</span>,</span>
<span>  cycles <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  cost <span class="op">=</span> <span class="va">cost</span>,</span>
<span>  effect <span class="op">=</span> <span class="va">utility</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"beginning"</span>,</span>
<span>  init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res_mod</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2 strategies run for 60 cycles.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initial state counts:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## PrimaryTHR = 1</span></span>
<span><span class="co">## SuccessP = 0</span></span>
<span><span class="co">## RevisionTHR = 0</span></span>
<span><span class="co">## SuccessR = 0</span></span>
<span><span class="co">## Death = 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Counting method: 'beginning'.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Values:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##           utility     cost</span></span>
<span><span class="co">## standard 14.65283 512.4327</span></span>
<span><span class="co">## np1      14.69734 610.3112</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Efficiency frontier:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## standard -&gt; np1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Differences:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Cost Diff. Effect Diff.     ICER     Ref.</span></span>
<span><span class="co">## np1   97.87858   0.04451095 2198.977 standard</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kevin Zarca, Antoine Filipovic-Pierucci.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
